# 功能规格说明书：隐蔽小说阅读器 (Stealth Novel Reader)

**功能分支**: `001-stealth-novel-reader`  
**创建日期**: 2025-12-30  
**状态**: 草案  
**输入**: 用户需求描述: "我需要写一个vscode插件，要求: 1. 这是一个用来摸鱼看小说的插件 2. 隐蔽性要好，不能让人看出来。 3. 可以支持的格式 txt epub。 4. 内置一个翻译插件，方便用来看英文小说，鼠标悬浮在对应的单词或者句子上的时候进行翻译。 5. 可以在编码界面翻页，上一页下一页，停止，开始阅读。并且停止之后要记住上一次阅读的位置。6. 我不知道你准备把小说显示在编辑器的哪个位置， 但是如果要放在编辑区域， 也就是代码区域， 以某种形式展现的话， 要记得能够自动换行。"

## 用户场景与测试 *(必填)*

### 用户场景 1 - 沉浸式隐蔽阅读 (优先级: P1)

作为一名正在编码的开发者，我希望在代码编辑器中阅读小说，内容应完美融入代码背景，不引起周围人的注意。

**优先级说明**: 隐蔽性是本插件的核心价值，直接决定了“摸鱼”的成功率。

**独立测试**: 在不影响现有代码运行的情况下，可以在编辑器窗口看到小说内容，且外观类似于代码注释。

**验收场景**:

1. **给定** 已打开一个代码文件，**当** 启动阅读模式并加载 TXT 文件时，**那么** 编辑器特定行会显示小说内容，颜色和字体与当前主题的注释一致。
2. **给定** 小说行显示中，**当** 窗口缩小时，**那么** 小说内容会自动换行，不会超出编辑器视图边界。

---

### 用户场景 2 - 进度记忆与翻页控制 (优先级: P1)

当我需要切换工作任务或有人经过时，我能快速停止阅读，并在稍后回到完全相同的位置。

**优先级说明**: 阅读连续性是基础体验，自动保存进度是必备功能。

**独立测试**: 关闭 VSCode 并重新打开后，阅读位置应保持不变。

**验收场景**:

1. **给定** 正在阅读第 10 页，**当** 点击“停止”或关闭插件时，**那么** 系统记录当前偏移量。
2. **给定** 重新启动插件时，**当** 加载同一本书，**那么** 自动跳转到上次停止的第 10 页位置。

---



### 用户场景 4 - 高级导航与搜索 (优先级: P2)



当我想快速定位到某一张或查找特定段落时，我可以使用搜索或直接跳转功能。



**优先级说明**: 针对长篇小说的必备功能，提升阅读体验的便捷性。



**独立测试**: 搜索文中存在的关键词，能列出结果并点击跳转；输入有效页码能准确跳转。



**验收场景**:



1. **给定** 已加载一本小说，**当** 输入“第 50 页”并确认，**那么** 阅读器立即跳转到第 50 页内容。

2. **给定** 正在阅读，**当** 搜索关键词“萧炎”时，**那么** 显示所有匹配结果及对应页码，点击后跳转。



## 功能需求 *(必填)*



### 功能需求列表



- **FR-001**: 系统必须支持 `.txt` 和 `.epub` 格式文件的解析与加载。

- **FR-002**: 隐蔽显示：系统必须将小说内容伪装成当前编程语言的“代码注释”形式（如 `//` 或 `#`）。

- **FR-003**: 自动换行：在代码区域显示时，内容必须根据编辑器宽度自动计算换行，确保文字完整可见。

- **FR-004**: 交互控制：必须支持通过快捷键或状态栏隐蔽按钮进行“上一页”、“下一页”、“开始”、“停止”、“跳转”和“搜索”操作。

- **FR-005**: 进度持久化：系统必须自动保存每本书的阅读进度（行号或字符偏移量）。

- **FR-006**: 悬浮翻译：系统必须集成翻译服务，支持鼠标悬停在单词或句子上时显示翻译结果。

- **FR-007**: 紧急隐藏（老板键）：必须支持通过自定义快捷键一键清空所有小说装饰，并立即使阅读器进入“停止”状态。

- **FR-008**: 视图配置：系统必须允许用户配置在代码区域同时显示的行数（例如：只显示 1 行、3 行或自定义行数）。

- **FR-009**: 精确跳转：系统必须支持根据用户配置的“每页字数”或“每页行数”计算总页数，并允许用户输入页码进行跳转。

- **FR-010**: 全文搜索：系统必须支持搜索关键词，计算匹配项所在的页码，并提供跳转列表。

### 关键实体

- **书籍 (Book)**: 包含文件路径、格式、编码、总长度。
- **阅读记录 (ReadingProgress)**: 包含书籍标识、最后阅读位置、最后访问时间。
- **翻译词条 (TranslationQuery)**: 包含原文、译文、上下文。

## 成功标准 *(必填)*

### 可衡量的结果

- **SC-001**: 插件启动时间及书籍加载时间（小于 1MB 的文件）应在 500ms 以内。
- **SC-002**: 隐蔽性验证：在距离屏幕 1 米处观察，普通人无法通过视觉特征（如颜色异常、图标显眼）区分小说内容与代码注释。
- **SC-003**: 翻译准确性：对于常用词汇，翻译结果的响应时间应低于 300ms。
- **SC-004**: 翻页操作成功率应为 100%，无死循环或内容重叠现象。